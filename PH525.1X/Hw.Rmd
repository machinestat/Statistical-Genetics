---
title: "Week 3 Homework"
author: "Shu Guo"
date: "Sunday, February 08, 2015"
output: pdf_document
---

Load the babies dataset:

```{r, echo=TRUE,cache=TRUE}
babies <- read.table("babies.txt", header = TRUE)
```

This is a very large dataset(1,236 cases), and we will pretend that it contains the entire population that we are interested in. As before, we will study the differences in birthweight between babies born to smoking and non-smoking mothers.

Fist, we split the into two birthweight datasets, one of birthweights to non-smoking mothers, and the other of birthweights to smoking mothers.

```{r}
bwt.nonsmoke <- babies$bwt[babies$smoke == 0]
bwt.smoke <- babies$bwt[babies$smoke == 1]
```

Now, we can look for the true population difference in means between smoking and non-smoking birthweights.

```{r}
mean(bwt.nonsmoke)-mean(bwt.smoke)
sd(bwt.nonsmoke)
sd(bwt.smoke)
```

The population difference of mean birthweights is about 8.9 ounces. The standard deviations of the nonsmoking and smoking groups are about 17.4 and 18.1 ounces, respectively.

We will treat the babies dataset as the full population, and draw samples from it to simulate individual experiments. We will then ask whether somebody who only received the random samples would be able to draw correct conclusions about the population. 

We are interested in testing whether the birth weights of babies born to non-smoking mothers are significantly different from the birth weights of babies born to smoking mothers.

Suppose we obtain two samples, each of size N, from non-smoking mothers (dat.ns) and smoking mothers (dat.s). We compute the t-value, which we call tval.

X.ns = mean(dat.ns)
sd.ns = sd(dat.ns)
X.s = mean(dat.s)
sd.s = sd(dat.s)
sd.diff = sqrt(sd.ns^2/N+sd.s^2/N)
tval = (X.ns - X.s)/sd.diff

Question 1.1   
Compute the t-value (t-statistic) for the first 30 weights of non-smoking mothers and the first 30 weights of smoking mothers. (The first 30 as they appear in the bwt.nonsmoke and bwt.smoke). Confirm that the t-statistic calculated manually and by t.test() is the same. What is the t-value (t-statistic)?

```{r}
N <- 30
dat_ns30 <- bwt.nonsmoke[1:30]
X_ns30 <- mean(dat_ns30)
sd_ns30 <- sd(dat_ns30)

dat_s30 <- bwt.smoke[1:30]
X_s30 <- mean(dat_s30)
sd_s30 <- sd(dat_s30)

sd_diff30 <- sqrt(sd_ns30^2/N + sd_s30^2/N)

tval30 <- (X_ns30 - X_s30)/sd_diff30
tval30
## p value generated by t.test()
t.test(dat_ns30, dat_s30)$statistic
```

Recall that we summarize our data using a t-value because we know that in situations where the null hypothesis is true (what we mean when we say "under the null") and the sample size is relatively large, this t-value will have an approximate standard normal distribution. Because we know the distribution of the t-value under the null, we can quantitatively determine how unusual the observed t-value would be if the null hypothesis were true.

The standard procedure is to examine the probability a t-value that actually does follow the null hypothesis would have larger absolute value than the absolute value of the t-value we just observed -- this is called a two-sided test.

One way to compute this probability is to take one minus the area under the standard normal curve between -abs(tval) and abs(tval). In R, we can do this using the pnorm function, which computes the area under a normal curve from negative infinity up to the value given as its first argument:

pval = 1- pnorm(abs(tval)) + pnorm(-abs(tval))

 Question 1.2 
 
 Because of the symmetry of the standard normal distribution, there is a simpler way to calculate the probability that a t-value under the null could have a larger absolute value than tval. Choose the simplified calculation from the following:
 
 2*pnorm(-abs(tval))
